South Asia Drought Indicators Based on LIS Land Data Assimilation SystemWanshu NieIntroductionThe South Asia Land Data Assimilation System (SALDAS), based on the Catchment and Surface Model (CLSM) under the framework of NASA Land Information System (LIS), enhances the value of GRACE observed terrestrial water storage (TWS) by spatially and temporally downscaling and vertical decomposition into water components (i.e. snow, soil moisture and groundwater). This project takes advantage of the GRACE Data Assimilation (GRACE-DA) system to develop the GRACE-based drought indicators for future scientific applications. This document will demonstrate 1) the workflow to perform GRACE-DA simulations for South Asia using Land Data Toolkit (LDT) and LIS; 2) the algorithm and workflow to generate drought indicators using Land Verification Toolkit (LVT) and 3) the workflow to develop the drought indicators datasets as an input for Tethys for visualization using NCAR Command Language (NCL).1. Running GRACE-DA Simulation1.1 running LDT (Mode: “LSM parameter processing”)For the 1st step, we will run LDT to process parameter data for LIS simulation. The file ldt.config_SALDAS provides you an example to generate these parameters and resample everything onto the LIS resolution for South Asia. The South Asia domain is at 0.01 degree and the GDAS met-forcing is used as suggested. Once you’ve successfully run LDT, you will have an output file named lis_input_clsm_saldas.10.nc, which will serve as an input for the next LIS simulation.1.2 running LIS (Mode: “retrospective”)For the 2nd step, we will run LIS to get an OpenLoop (OL) simulation. Normally, OL simulation is performed at “retrospective” mode and should have sufficient ensemble members generated by the perturbed state and forcing variables in order to ensure that all the ensemble members are nicely distributed and never hit the physical bounds. However, since the CLSM based GRACE-DA system is well understood and qualified. Here we only generate single member to perform the OL simulations to save computational resources. Please see lis.config_saldas_openloop as an example for OL run.1.3 running LDT (Mode: “Ensemble restart processing”)For the 3rd step, we will run LDT to enrich the ensemble members of the restart file which will be used in the Data Assimilation (DA) run. Since the GRACE observation start to be available at April 2002, we will use the restart file of March 2002 from the LIS output got by step 2 to generate a 20 ensemble members restart file. Please see the configure file ldt.config_20ens_restart_200204 as an example, and you will get an output NetCDF file named clsm_ol_ensrst_200204_init_2002--03312330.nc after the LDT run.1.4 running LDT (Mode: “DA preprocessing”)For the 4th step, we will run LDT to generate the GRACE observations for the study area. Note that original GRACE datasets are TWS anomalies, while for DA purpose, we need to convert the anomalies into TWS by adding a baseline to the anomalies and this baseline will be provided by the output of the OL simulation. Please see ldt.config_graceobs as an example.1.5 running LIS (Mode: “ensemble smoother”)This is the final step for the DA simulation. It will take the output from step 3 and 4 and also the observation, state and forcing attribute and perturbation parameter files to conduct the ensemble simulation and the GRACE observation will be assimilated into the model result at monthly scale and smoothed with daily increments. Please see lis.config_20mmobserr_20mems as an example.2. Generating Drought Indicators2.1 MethodEstimates of drought will be generated through percentile based indices for surface soil moisture (top 10 cm), root zone soil moisture (top 1 m) and TWS. The algorithm will be in a manner similar to that used in the NLDAS drought monitoring system. The anomalies and percentiles are based on a 17-year climatology (2000-2016) and the steps are concluded as follows (take TWS as an example):1) TWS climatology is computed based on daily output of each variable for each of the grid point. A 5-day moving window of TWS values for that variable are used to calculate the climatology of a particular calendar day in order to smooth out the TWS record. For example, Aug 25th climatology is assembled by using all values from 23th to 27th Aug, across all 17 years, resulting in a pool of 5?17=85 values for each calendar day. 2) The daily percentile values are computed by ranking the real estimated TWS against the climatology pool on that day. For example, TWS of Aug 25th 2012 will be ranked by locating its position in the 85 values of Aug 25th climatology. 3) The weekly percentile values will be computed for each variable.4) Finally, the drought intensities are categorized based on the percentile value: D0 (abnormally dry, percentile ≤ 30%), D1 (moderate drought, percentile ≤ 20%), D2 (severe drought, percentile ≤ 10%), D3 (extreme drought, percentile ≤ 5%), D4 (exceptional drought, percentile ≤ 2%).2.2 running LVTComputing percentiles requires two passes through the data:1) First pass to compute the climatology2) Second pass to derive the indices relative to the climatology.However, these two passes can be automatically completed through one configure file, please see lvt.config_clim_perc_tws as an example.2.3 running NCLOnce you have the three sets of the weekly based drought indicators, you could use NCL script (getPERCall.ncl) to organize the files at yearly basis and the data structure of each file will contain time, 1-D latitude, 1-D longitude, and the three drought indicators in terms of time, lat and lon (see Appendix for data structure).Appendix A: Configure files for running GRACE-DA simulationA.1. ldt.config_SALDASLDT running mode:                      "LSM parameter processing" ##LSM parameter attributes file:         ./param_attribs.txt_clsmf25  # List of LSM Parameter typesProcessed LSM parameter filename:      ./lis_input_clsm_saldas.10.ncLIS number of nests:                   1Number of surface model types:         1Surface model types:                 "LSM" #"Lake"Land surface model:                   CLSMF2.5Lake model:                           none#Routing model:                        HYMAPWater fraction cutoff value:          0.5Number of met forcing sources:          1            # Enter number of forcing typesMet forcing sources:                  "GDAS"       # Enter 'none' if no forcing selectedMet spatial transform methods:        bilinearTopographic correction method (met forcing):   "lapse-rate"LDT diagnostic file:                   ldtlogLDT output directory:               ./Number of ensembles per tile:          1LIS output timestep:                   "1da" #86400Undefined value:                      -9999.0Metrics output directory:              OUTPUT#processor layoutNumber of processors along x:       1Number of processors along y:       1#LIS domainMap projection of the LIS domain:       latlonRun domain lower left lat:           5.95Run domain lower left lon:          59.95Run domain upper right lat:         40.05Run domain upper right lon:        100.05Run domain resolution (dx):          0.1Run domain resolution (dy):          0.1# -------------------------------# Landcover/Mask Parameter Inputs #Landcover classification:        "MOSAIC"Landcover data source:           "CLSMF2.5"Landcover map projection:        latlonLandcover spatial transform:     noneLandcover file:               ./LS_PARAMETERS/clsmf25_parms/SouthAsia_0.1-deg/mosaic_veg_typs_fracsLandcover spatial transform:     tile # noneLandcover lower left lat:         5.95Landcover lower left lon:        59.95Landcover upper right lat:       40.05Landcover upper right lon:       100.05Landcover resolution (dx):        0.1Landcover resolution (dy):        0.1Landcover fill option:   neighbor    # none, neighborLandcover fill radius:     3.        # Number of pixels to search for neighborLandcover fill value:      5.        # Static value to fill where missingCreate or readin landmask:     "readin"Landmask data source:           "CLSMF2.5"Landmask file:           ./LS_PARAMETERS/clsmf25_parms/SouthAsia_0.1-deg/South-Asia-mask_0.1_Catch-IGBPNCEP.1gd4rLandmask spatial transform:    noneLandmask map projection:        latlonLandmask lower left lat:        5.95Landmask lower left lon:       59.95Landmask upper right lat:      40.05Landmask upper right lon:      100.05Landmask resolution (dx):        0.1Landmask resolution (dy):        0.1Incorporate crop information:  .false.      # Option to modify LSM parameters if crop info present#Catchment LSM Parms:CLSMF25 tile coordinate file:    ./LS_PARAMETERS/clsmf25_parms/SouthAsia_0.1-deg/PE_7200x3600_DE_0376x0338.fileCLSMF25 tile veg file:           ./LS_PARAMETERS/clsmf25_parms/SouthAsia_0.1-deg/mosaic_veg_typs_fracsCLSMF25 soil param file:         ./LS_PARAMETERS/clsmf25_parms/SouthAsia_0.1-deg/soil_param.datCLSMF25 topo ar file:            ./LS_PARAMETERS/clsmf25_parms/SouthAsia_0.1-deg/ar.newCLSMF25 topo bf file:            ./LS_PARAMETERS/clsmf25_parms/SouthAsia_0.1-deg/bf.datCLSMF25 topo ts file:            ./LS_PARAMETERS/clsmf25_parms/SouthAsia_0.1-deg/ts.datCLSMF25 surf layer ts file:      ./LS_PARAMETERS/clsmf25_parms/SouthAsia_0.1-deg/tau_param.datCLSMF25 MODIS directory:         ./LS_PARAMETERS/cat_parms/MODIS_alb/CLSMF25 greenness climatology file:  ./LS_PARAMETERS/clsmf25_parms/SouthAsia_0.1-deg/green.dataCLSMF25 LAI climatology file:    ./LS_PARAMETERS/clsmf25_parms/SouthAsia_0.1-deg/lai.dataCLSMF25 add to bedrock depth:      2.0CLSMF25 top soil layer depth:       0.02      # in metersCLSMF25 map projection:             latlonCLSMF25 spatial transform:           noneCLSMF25 lower left lat:              5.95CLSMF25 lower left lon:             59.95CLSMF25 upper right lat:            40.05CLSMF25 upper right lon:           100.05CLSMF25 resolution (dx):             0.1CLSMF25 resolution (dy):             0.1#Soil parameters:#Sand fraction map:   ../input/1KM/sand_FAO.1gd4r#Clay fraction map:  ../input/1KM/clay_FAO.1gd4r#Silt fraction map:  ../input/1KM/silt_FAO.1gd4r#Soil depth map:Porosity data source: CLSMF2.5Porosity map:       ./LS_PARAMETERS/clsmf25_parms/SouthAsia_0.1-deg/soil_param.datSaturated matric potential map:Saturated hydraulic conductivity map:b parameter map:Soils spatial transform:      none    !Note: do not use mode with soil fractionsSoils map projection:        latlonSoils lower left lat:          5.95Soils lower left lon:         59.95Soils upper right lat:        40.05Soils upper right lon:        100.05Soils resolution (dx):          0.1Soils resolution (dy):          0.1Soils fill option:   neighborSoils fill radius:   3Soils fill value:    0.33Porosity fill value: 0.30Elevation map:   ./LS_PARAMETERS/topo_parms/SRTM/SRTM30/raw      # Elevation map file | directoryElevation data source:      SRTM_NativeElevation fill option:          average                 # none | average | neighborElevation fill radius:            5.                    # radiusElevation fill value:            300.                   # In metersTopography spatial transform:   average                 # neighbor | average | bilinear | budget-bilinear | tileTopography map projection:       latlonElevation number of bands:     1Slope number of bands:         1Aspect number of bands:        1# Albedo maps:Albedo NIR factor file: ./LS_PARAMETERS/clsmf25_parms/SouthAsia_0.1-deg/AlbMap.WS.2x5.00-04.monthly-tile.0.7_5.0.datAlbedo VIS factor file: ./LS_PARAMETERS/clsmf25_parms/SouthAsia_0.1-deg/AlbMap.WS.2x5.00-04.monthly-tile.0.3_0.7.datAlbedo climatology interval:     monthly                # monthly | quarterlyAlbedo spatial transform:        none                   # average | neighbor | bilinear | budget-bilinearAlbedo fill option:              neighbor               # none | neighbor | averageAlbedo fill radius:                5                    # Number of pixels to search for neighborAlbedo fill value:                0.14                  # Static value to fill where missingAlbedo map projection:           latlonAlbedo lower left lat:              5.95Albedo lower left lon:             59.95Albedo upper right lat:            40.05Albedo upper right lon:           100.05Albedo resolution (dx):             0.1Albedo resolution (dy):             0.1#Greenness inputsGreenness data source:                 "CLSMF2.5"Greenness fraction map:                 ./LS_PARAMETERS/clsmf25_parms/SouthAsia_0.1-deg/green.datGreenness climatology interval:         monthlyCalculate min-max greenness fraction:  .true. #.false.Greenness maximum map:                  noneGreenness minimum map:                  noneGreenness spatial transform:            noneGreenness fill option:                  noneGreenness map projection:               latlonGreenness lower left lat:                  5.95Greenness lower left lon:                 59.95Greenness upper right lat:                40.05Greenness upper right lon:               100.05Greenness resolution (dx):                 0.1Greenness resolution (dy):                 0.1Greenness fill option:          averageGreenness fill radius:           3Greenness fraction fill value:  0.20Greenness maximum fill value:   0.80Greenness minimum fill value:   0.05Greenness fill value:  0.20#LAI mapsLAI data source:                 "CLSMF2.5"LAI map:                                ./LS_PARAMETERS/clsmf25_parms/SouthAsia_0.1-deg/lai.datSAI map:                                noneCalculate min-max LAI:                  trueLAI/SAI climatology interval:           monthlyLAI/SAI spatial transform:              noneLAI/SAI fill option:                    noneLAI/SAI map projection:                 latlonLAI/SAI lower left lat:                   5.95LAI/SAI lower left lon:                   59.95LAI/SAI upper right lat:                  40.05LAI/SAI upper right lon:                 100.05LAI/SAI resolution (dx):                   0.1LAI/SAI resolution (dy):                   0.1LAI/SAI fill option:     averageLAI/SAI fill radius:        3LAI fill value:             1SAI fill value:            0.5LIS maximum number of surface type tiles per grid:     1LIS minimum cutoff percentage (surface type tiles):    0.10LIS maximum number of soil texture tiles per grid:     1LIS minimum cutoff percentage (soil texture tiles):    0.10LIS maximum number of soil fraction tiles per grid:    1LIS minimum cutoff percentage (soil fraction tiles):   0.10LIS maximum number of elevation bands per grid:        1LIS minimum cutoff percentage (elevation bands):       0.10LIS maximum number of slope bands per grid:            1LIS minimum cutoff percentage (slope bands):           0.10LIS maximum number of aspect bands per grid:           1LIS minimum cutoff percentage (aspect bands):          0.10Maximum number of surface type tiles per grid: 1Minimum cutoff percentage (surface type tiles): 10Maximum number of soil texture tiles per grid: 1Minimum cutoff percentage (soil texture tiles): 10Maximum number of soil fraction tiles per grid: 1Minimum cutoff percentage (soil fraction tiles): 10Maximum number of elevation bands per grid: 3Minimum cutoff percentage (elevation bands): 10Maximum number of slope bands per grid: 3Minimum cutoff percentage (slope bands): 10Maximum number of aspect bands per grid: 3Minimum cutoff percentage (aspect bands): 10GDAS T126 elevation map: ./LS_PARAMETERS/metforcing_parms/GDAS/global_orography.t126.grbGDAS T170 elevation map: ./LS_PARAMETERS/metforcing_parms/GDAS/global_orography.t170.grbGDAS T254 elevation map: ./LS_PARAMETERS/metforcing_parms/GDAS/global_orography.t254.grbGDAS T382 elevation map: ./LS_PARAMETERS/metforcing_parms/GDAS/global_orography.t382.grbGDAS T574 elevation map: ./LS_PARAMETERS/metforcing_parms/GDAS/global_orography.t574.grbGDAS T1534 elevation map: ./LS_PARAMETERS/metforcing_parms/GDAS/global_orography_uf.t1534.3072.1536.grbA.2. lis.config_saldas_openloop#Overall driver optionsRunning mode:                           retrospectiveMap projection of the LIS domain:       latlonNumber of nests:                        1Number of surface model types:          1Surface model types:                    LSMSurface model output interval:          1daLand surface model:                     "CLSM F2.5"Number of ensembles per tile:           1Number of met forcing sources:          1Met forcing sources:                   "GDAS"Blending method for forcings:          "overlay"Topographic correction method (met forcing):   "lapse-rate"Enable spatial downscaling of precipitation:   0   0Spatial interpolation method (met forcing):   "bilinear"  # "neighbor"Spatial upscaling method (met forcing):       "none"Temporal interpolation method (met forcing):  "linear"#Runtime optionsForcing variables list file:              './CLSM_InputFiles/forcing_variables.txt'Output forcing:                            1   #1-yesOutput parameters:                         0   #0- noOutput methodology:                        "2d gridspace"Output model restart files:                1Output data format:                        "netcdf"Output naming style:                       "3 level hierarchy"Start mode:                                restartStarting year:                             2015Starting month:                            3Starting day:                              1Starting hour:                             0Starting minute:                           0Starting second:                           0Ending year:                               2016Ending month:                              8Ending day:                                31Ending hour:                               23Ending minute:                             55Ending second:                             55Undefined value:                          -9999Output directory:                         "./OLv1/"Diagnostic output file:                   "./OLv1/lislog"HYMAP diagnostic output file:             "./OLv1/hymaplog"#The following options are used for subgrid tiling based on vegetationMaximum number of surface type tiles per grid:    1Minimum cutoff percentage (surface type tiles):   0.05Maximum number of soil texture tiles per grid:    1Minimum cutoff percentage (soil texture tiles):   0.05Maximum number of soil fraction tiles per grid:   1Minimum cutoff percentage (soil fraction tiles):  0.05Maximum number of elevation bands per grid:       1Minimum cutoff percentage (elevation bands):      0.05Maximum number of slope bands per grid:           1Minimum cutoff percentage (slope bands):          0.05Maximum number of aspect bands per grid:          1Minimum cutoff percentage (aspect bands):         0.05#Processor layout#Should match the total number of processor usedNumber of processors along x:           4 Number of processors along y:           7Halo size along x:                      0Halo size along y:                      0#Sub-modelsRadiative transfer model:               noneNumber of application models:           0##------------------------ ROUTING -------------------------------------##HYMAP router#Routing model:                        "HYMAP router" ##Routing model:                        "none"##TEMPLATE model timestep:              "15mn"#HYMAP routing model time step:        "15mn" #HYMAP routing model output interval:  "1da"#HYMAP routing model restart interval: "1mo"### method:                         enter 1 - kinematic; 2 - diffusive; 3 - "local inertia"## linear reservoir flag:          enter 1 - use; or 2 - do not use linear reservoirs## evaporation option:             enter 1 - compute; or 2 - do not compute evapotation in floodplains;## floodplain dynamics option:     enter 1 - compute floodplain dynamics; or 0 - do not compute floodplain dynamics## time step method:      enter "constant" or "adaptive" ## if "adaptive" time step, provide alfa coefficient value## if reservoir operation, provide alfa coefficient value## #HYMAP routing method:                      "kinematic"    # "local inertia" #HYMAP routing model time step method:      "constant"     # "adaptive" #HYMAP routing model adaptive time step alfa coefficient: 0.5#HYMAP routing model linear reservoir flag:  1#HYMAP routing model evaporation option:     1  #1=do not compute, 2=compute#HYMAP routing model evaporation data source:   "readin"   # readin only##HYMAP routing model start mode:    coldstart##HYMAP routing model start mode:          restart #HYMAP routing model restart file:      ./SPINUP2_25KM/ROUTING/201601/LIS_RST_HYMAP_router_201601010000.d01.bin##HYMAP routing model restart file:      ./OLv3_25KM/ROUTING/201601/LIS_RST_HYMAP_router_201601010000.d01.bin#HYMAP run in ensemble mode:                 0##HYMAP floodplain dynamics:         1##HYMAP reservoir operation option:  0#HYMAP number of reservoirs:        1#HYMAP reservoir operation input time series size: 2#HYMAP reservoir operation input directory: ./#HYMAP reservoir operation header filename: ./header_test.txt#HYMAP reservoir operation input data type: "water level" # "streamflow" ###External runoff data source:   "LIS runoff output"##GLDAS1 runoff data output directory: ./GLDAS1/NOAH10/#GLDAS1 runoff data model name:        NOAH#GLDAS1 runoff data output interval:  "3hr"#GLDAS1 runoff data spatial resolution (degree): 1.0##NLDAS2 runoff data output directory: ./NLDAS2.NOAH/#NLDAS2 runoff data model name:        NOAH#NLDAS2 runoff data output interval:  "1hr"##LIS runoff output directory:   './CLSM/005/SPINUP/'#LIS runoff output interval:    '1da'#---------------------DATA ASSIMILATION ----------------------------------#Data Assimilation OptionsNumber of data assimilation instances:  0Data assimilation algorithm:            noneData assimilation set:                  noneData assimilation exclude analysis increments:      0Data assimilation output interval for diagnostics:  1daData assimilation number of observation types:      0Data assimilation output ensemble members:          0Data assimilation output processed observations:    0Data assimilation output innovations:               0Data assimilation use a trained forward model:       0Data assimilation trained forward model output file: none#Bias estimation optionsBias estimation algorithm:                 noneBias estimation attributes file:           noneBias estimation restart output frequency:  1daBias estimation start mode:                noneBias estimation restart file:              none#Perturbation optionsPerturbations start mode:                  coldstartPerturbations restart output interval:     1daPerturbations restart filename:            noneForcing perturbation algorithm:            noneForcing perturbation frequency:            1hrForcing attributes file:                   noneForcing perturbation attributes file:      noneState perturbation algorithm:              noneState perturbation frequency:              1hrState attributes file:                     noneState perturbation attributes file:        noneObservation perturbation algorithm:        noneObservation perturbation frequency:        1hrObservation attributes file:               noneObservation perturbation attributes file:  none# ------------------------------------------------------#The following options list the choice of parameter maps to be usedLIS domain and parameter data file:   ./lis_input_clsm_saldas.10.ncLandmask data source:                   LDTLandcover data source:                  LDTSoil texture data source:               noneSoil fraction data source:              noneSoil color data source:                 noneElevation data source:                  LDTSlope data source:                      noneAspect data source:                     noneCurvature data source:                  noneLAI data source:                        LDTSAI data source:                        noneAlbedo data source:                     noneMax snow albedo data source:            noneGreenness data source:                  LDTRoughness data source:                  nonePorosity data source:                   LDTKsat data source:                       noneB parameter data source:                noneQuartz data source:                     noneEmissivity data source:                 none##--------------------------------FORCINGS----------------------------------## MERRA-2 base forcing:#MERRA2 forcing directory:       ../../MET_FORCING/MERRA2/#MERRA2 use corrected total precipitation:  1## Run MERRA2 with reference height fields:#MERRA2 use lowest model level forcing:     0    # Major difference for v2! [KRA]##MERRA2 use lowest model level forcing:     1### RFE2_GDAS (RFE2-temporally disaggregated by GDAS/CMAP data):#RFE2gdas forcing directory:     ../../MET_FORCING/CHIRPSv2/6-hrly/### CHIRPS temp. downscaled with MERRA-2 corrected precipitation (LDT):#Generated metforcing directory:  /discover/nobackup/projects/fame/MET_FORCING/MERRA2_CHIRPS/OUTPUT/#---------------------------------FORCINGS---------------------------------GDAS forcing directory:                   ./MET_FORCING/GDASGDAS domain x-dimension size:             512GDAS domain y-dimension size:             256GDAS number of forcing variables:         9#-----------------------LAND SURFACE MODELS--------------------------CLSM F2.5 model timestep:                 30mnCLSM F2.5 restart output interval:        1mo#CLSM F2.5 restart file:                  ./SPINUP2_25KM/SURFACEMODEL/201601/LIS_RST_CLSMF25_201601010000.d01.ncCLSM F2.5 restart file:                  ./OLv1/SURFACEMODEL/201502/LIS_RST_CLSMF25_201502282330.d01.ncCLSM F2.5 top soil layer depth:           0.02      # in metersCLSM F2.5 initial soil moisture:          0.30 CLSM F2.5 initial soil temperature:       290.0CLSM F2.5 fixed reference height:         10 CLSM F2.5 turbulence scheme:              0CLSM F2.5 use MODIS albedo flag:          1Scaling factor file:                      none#---------------------------MODEL OUTPUT CONFIGURATION-----------------------#Specify the list of ALMA variables that need to be featured in theModel output attributes file:           './CLSM_InputFiles/MODEL_OUTPUT_LIST_CLSM25.TBL'#LSM model outputOutput start year:Output start month:Output start day:Output start hour:Output start minutes:Output start seconds:A.3. ldt.config_20ens_restart_200204# == LDT Main Entry Options ==LDT running mode:                  "Ensemble restart processing"  # LDT type of run-mode (top-level option)Processed LSM parameter filename:  "./lis_input_clsm_saldas.10.nc"   # Final output file read by LIS-7LIS number of nests:                   1                # Total number of nests run by LISNumber of surface model types:         1                # Total number of desired surface model typesSurface model types:                 "LSM"              # Surface models:  LSM | OpenwaterLand surface model:                  "none"             # Enter LSM(s) of choiceLake model:                          "none"             # Enter Lake model(s) of choice#Routing model:                       "HYMAP"            # Add routing model when running HYMAPWater fraction cutoff value:          0.5               # Fraction at which gridcell is designated as 'water'Incorporate crop information:       .false.             # .true. = incorporate crop/irrig info with LSM parametersNumber of met forcing sources:         0                # Enter number of forcing typesMet forcing sources:                 "none"             # Enter 'none' if no forcing selectedMet spatial transform methods:        none              # bilinear | budget-bilinear | neighbor | averageTopographic correction method (met forcing):  "none"    # none | lapse-rate#Starting year:                   2004#Starting month:                   4#Starting day:                     1#Starting hour:                    0#Starting minute:                  0#Starting second:                  0#Ending year:                     2004#Ending month:                     6#Ending day:                       1#Ending hour:                      0#Ending minute:                    0#Ending second:                    0LDT diagnostic file:             ./ldtlog_ensrstUndefined value:                  -9999.0               # Universal undefined valueLDT output directory:              OUTPUT               # If metrics or stats are written outNumber of ensembles per tile:        1                  # The number of ensemble members per tile# Processor layout (currently not available for ensemble restarts)Number of processors along x:       1Number of processors along y:       1#LDT/LIS domain and grid:Map projection of the LIS domain:   latlon# HPA Test case Region:Run domain lower left lat:           5.95Run domain lower left lon:           59.95Run domain upper right lat:          40.05Run domain upper right lon:          100.05Run domain resolution (dx):          0.1Run domain resolution (dy):          0.1# Ensemble Restart Section:Ensemble restart generation mode:   "upscale"Number of ensembles per tile (input restart):   1Number of ensembles per tile (output restart):  20# CLSM LSM OL RESTART FILES:LIS restart source:                "LSM"Input restart filename:         ./OLv1/SURFACEMODEL/200203/LIS_RST_CLSMF25_200203312330.d01.ncOutput restart filename:        ./clsm_ol_ensrst_200204_init_200203312330.nc# ---Maximum number of surface type tiles per grid:     1Minimum cutoff percentage (surface type tiles):    0.10Maximum number of soil texture tiles per grid:     1Minimum cutoff percentage (soil texture tiles):    0.10Maximum number of soil fraction tiles per grid:    1Minimum cutoff percentage (soil fraction tiles):   0.10Maximum number of elevation bands per grid:        1Minimum cutoff percentage (elevation bands):       0.10Maximum number of slope bands per grid:            1Minimum cutoff percentage (slope bands):           0.10Maximum number of aspect bands per grid:           1Minimum cutoff percentage (aspect bands):          0.10# == Landcover, Landmask and Soil Texture Parameters ==# Landcover/Mask Parameter Inputs Landcover classification:        "MOSAIC"Landcover data source:           "CLSMF2.5"Landcover map projection:        latlonLandcover spatial transform:     noneLandcover file:               ./LS_PARAMETERS/clsmf25_parms/SouthAsia_0.1-deg/mosaic_veg_typs_fracsLandcover spatial transform:     tile # noneLandcover lower left lat:         5.95Landcover lower left lon:        59.95Landcover upper right lat:       40.05Landcover upper right lon:       100.05Landcover resolution (dx):        0.1Landcover resolution (dy):        0.1Landcover fill option:   neighbor    # none, neighborLandcover fill radius:     3.        # Number of pixels to search for neighborLandcover fill value:      5.        # Static value to fill where missingCreate or readin landmask:     "readin"Landmask data source:           "CLSMF2.5"Landmask file:           ./LS_PARAMETERS/clsmf25_parms/SouthAsia_0.1-deg/South-Asia-mask_0.1_Catch-IGBPNCEP.1gd4rLandmask spatial transform:    noneLandmask map projection:        latlonLandmask lower left lat:        5.95Landmask lower left lon:       59.95Landmask upper right lat:      40.05Landmask upper right lon:      100.05Landmask resolution (dx):        0.1Landmask resolution (dy):        0.1#Catchment LSM Parms:CLSMF25 tile coordinate file:    ./LS_PARAMETERS/clsmf25_parms/SouthAsia_0.1-deg/PE_7200x3600_DE_0376x0338.fileCLSMF25 tile veg file:           ./LS_PARAMETERS/clsmf25_parms/SouthAsia_0.1-deg/mosaic_veg_typs_fracsCLSMF25 soil param file:         ./LS_PARAMETERS/clsmf25_parms/SouthAsia_0.1-deg/soil_param.datCLSMF25 topo ar file:            ./LS_PARAMETERS/clsmf25_parms/SouthAsia_0.1-deg/ar.newCLSMF25 topo bf file:            ./LS_PARAMETERS/clsmf25_parms/SouthAsia_0.1-deg/bf.datCLSMF25 topo ts file:            ./LS_PARAMETERS/clsmf25_parms/SouthAsia_0.1-deg/ts.datCLSMF25 surf layer ts file:      ./LS_PARAMETERS/clsmf25_parms/SouthAsia_0.1-deg/tau_param.datCLSMF25 MODIS directory:         ./LS_PARAMETERS/cat_parms/MODIS_alb/CLSMF25 greenness climatology file:  ./LS_PARAMETERS/clsmf25_parms/SouthAsia_0.1-deg/green.dataCLSMF25 LAI climatology file:    ./LS_PARAMETERS/clsmf25_parms/SouthAsia_0.1-deg/lai.dataCLSMF25 add to bedrock depth:      2.0CLSMF25 top soil layer depth:       0.02      # in metersCLSMF25 map projection:             latlonCLSMF25 spatial transform:           noneCLSMF25 lower left lat:              5.95CLSMF25 lower left lon:             59.95CLSMF25 upper right lat:            40.05CLSMF25 upper right lon:           100.05CLSMF25 resolution (dx):             0.1CLSMF25 resolution (dy):             0.1Porosity data source: CLSMF2.5Porosity map:       ./LS_PARAMETERS/clsmf25_parms/SouthAsia_0.1-deg/soil_param.datSaturated matric potential map:Saturated hydraulic conductivity map:b parameter map:Soils spatial transform:      none    !Note: do not use mode with soil fractionsSoils map projection:        latlonSoils lower left lat:          5.95Soils lower left lon:         59.95Soils upper right lat:        40.05Soils upper right lon:        100.05Soils resolution (dx):          0.1Soils resolution (dy):          0.1Soils fill option:   neighborSoils fill radius:   3Soils fill value:    0.33Porosity fill value: 0.30Elevation map:   ./LS_PARAMETERS/topo_parms/SRTM/SRTM30/raw      # Elevation map file | directoryElevation data source:      SRTM_NativeElevation fill option:          average                 # none | average | neighborElevation fill radius:            5.                    # radiusElevation fill value:            300.                   # In metersTopography spatial transform:   average                 # neighbor | average | bilinear | budget-bilinear | tileTopography map projection:       latlonElevation number of bands:     1Slope number of bands:         1Aspect number of bands:        1# Albedo maps:Albedo NIR factor file: ./LS_PARAMETERS/clsmf25_parms/SouthAsia_0.1-deg/AlbMap.WS.2x5.00-04.monthly-tile.0.7_5.0.datAlbedo VIS factor file: ./LS_PARAMETERS/clsmf25_parms/SouthAsia_0.1-deg/AlbMap.WS.2x5.00-04.monthly-tile.0.3_0.7.datAlbedo climatology interval:     monthly                # monthly | quarterlyAlbedo spatial transform:        none                   # average | neighbor | bilinear | budget-bilinearAlbedo fill option:              neighbor               # none | neighbor | averageAlbedo fill radius:                5                    # Number of pixels to search for neighborAlbedo fill value:                0.14                  # Static value to fill where missingAlbedo map projection:           latlonAlbedo lower left lat:              5.95Albedo lower left lon:             59.95Albedo upper right lat:            40.05Albedo upper right lon:           100.05Albedo resolution (dx):             0.1Albedo resolution (dy):             0.1#Greenness inputsGreenness data source:                 "CLSMF2.5"Greenness fraction map:                 ./LS_PARAMETERS/clsmf25_parms/SouthAsia_0.1-deg/green.datGreenness climatology interval:         monthlyCalculate min-max greenness fraction:  .true. #.false.Greenness maximum map:                  noneGreenness minimum map:                  noneGreenness spatial transform:            noneGreenness fill option:                  noneGreenness map projection:               latlonGreenness lower left lat:                  5.95Greenness lower left lon:                 59.95Greenness upper right lat:                40.05Greenness upper right lon:               100.05Greenness resolution (dx):                 0.1Greenness resolution (dy):                 0.1Greenness fill option:          averageGreenness fill radius:           3Greenness fraction fill value:  0.20Greenness maximum fill value:   0.80Greenness minimum fill value:   0.05Greenness fill value:  0.20#LAI mapsLAI data source:                 "CLSMF2.5"LAI map:                                ./LS_PARAMETERS/clsmf25_parms/SouthAsia_0.1-deg/lai.datSAI map:                                noneCalculate min-max LAI:                  trueLAI/SAI climatology interval:           monthlyLAI/SAI spatial transform:              noneLAI/SAI fill option:                    noneLAI/SAI map projection:                 latlonLAI/SAI lower left lat:                   5.95LAI/SAI lower left lon:                   59.95LAI/SAI upper right lat:                  40.05LAI/SAI upper right lon:                 100.05LAI/SAI resolution (dx):                   0.1LAI/SAI resolution (dy):                   0.1LAI/SAI fill option:     averageLAI/SAI fill radius:        3LAI fill value:             1SAI fill value:            0.5GDAS T126 elevation map: ./LS_PARAMETERS/metforcing_parms/GDAS/global_orography.t126.grbGDAS T170 elevation map: ./LS_PARAMETERS/metforcing_parms/GDAS/global_orography.t170.grbGDAS T254 elevation map: ./LS_PARAMETERS/metforcing_parms/GDAS/global_orography.t254.grbGDAS T382 elevation map: ./LS_PARAMETERS/metforcing_parms/GDAS/global_orography.t382.grbGDAS T574 elevation map: ./LS_PARAMETERS/metforcing_parms/GDAS/global_orography.t574.grbGDAS T1534 elevation map: ./LS_PARAMETERS/metforcing_parms/GDAS/global_orography_uf.t1534.3072.1536.grbA.4. ldt.config_graceobs#Overall driver optionsLDT running mode:                  "DA preprocessing"Processed LSM parameter filename:  ./lis_input_clsm_saldas.10.ncLIS number of nests:                   1         # 1 nest supported for nowNumber of surface model types:         1Surface model types:                  LSM        # LSM | LakeLand surface model:                  "CLSMF2.5"  # Enter LSM of choiceRouting model:                       'none' Lake model:                          'none'      # Lake model option: 'none'|'FLake'Water fraction cutoff value:          0.5Incorporate crop information:        .false.Number of met forcing sources:         0         # Enter number of forcing typesMet forcing sources:                 none        # Enter 'none' if no forcing selectedMet spatial transform methods:      "none" Topographic correction method (met forcing):   "none" Number of ensembles per tile:         1Undefined value:                    -9999.0LDT output directory:               "./DA_TWS/GRACEOBS_JPLms"LDT diagnostic file:                "./ldtlog_gracetws_clsm"# Processor layoutNumber of processors along x:       1Number of processors along y:       1#LDT/LIS domain and grid:Map projection of the LIS domain:   latlon# Obs space domain when run domain is at 0.1 deg:#Run domain lower left lat:          6.875   # 7.05  #Run domain lower left lon:          31.875  # 32.05 #Run domain upper right lat:         18.125  # 17.95 #Run domain upper right lon:         40.125  # 39.95   #Run domain resolution (dx):         0.25    # 0.1 #Run domain resolution (dy):         0.25    # 0.1 # Obs space domain when run domain is at 0.25 deg:#Run domain lower left lat:    7.125#Run domain lower left lon:    32.125#Run domain upper right lat:   17.875#Run domain upper right lon:   39.875#Run domain resolution (dx):   0.25#Run domain resolution (dy):   0.25# Obs space domain when run domain is at 0.5 deg:Run domain lower left lat:    6.25Run domain lower left lon:    60.25Run domain upper right lat:   39.75Run domain upper right lon:   99.75Run domain resolution (dx):   0.5Run domain resolution (dy):   0.5### --------------------------------------------# Landcover/Mask Parameter Inputs #Landcover classification:        "MOSAIC"Landcover data source:           "CLSMF2.5"Landcover map projection:        latlonLandcover spatial transform:     noneLandcover file:               ./LS_PARAMETERS/clsmf25_parms/SouthAsia_0.1-deg/mosaic_veg_typs_fracsLandcover spatial transform:     tile # noneLandcover lower left lat:         5.95Landcover lower left lon:        59.95Landcover upper right lat:       40.05Landcover upper right lon:       100.05Landcover resolution (dx):        0.1Landcover resolution (dy):        0.1Landcover fill option:   neighbor    # none, neighborLandcover fill radius:     3.        # Number of pixels to search for neighborLandcover fill value:      5.        # Static value to fill where missingCreate or readin landmask:    "readin"Landmask data source:         "CLSMF2.5"Landmask file:           ./LS_PARAMETERS/clsmf25_parms/SouthAsia_0.1-deg/South-Asia-mask_0.1_Catch-IGBPNCEP.1gd4rLandmask spatial transform:    tileLandmask map projection:        latlonLandmask lower left lat:        5.95Landmask lower left lon:       59.95Landmask upper right lat:      40.05Landmask upper right lon:      100.05Landmask resolution (dx):        0.1Landmask resolution (dy):        0.1#Catchment LSM Parms:CLSMF25 tile coordinate file:    ./LS_PARAMETERS/clsmf25_parms/SouthAsia_0.1-deg/PE_7200x3600_DE_0376x0338.fileCLSMF25 tile veg file:           ./LS_PARAMETERS/clsmf25_parms/SouthAsia_0.1-deg/mosaic_veg_typs_fracsCLSMF25 soil param file:         ./LS_PARAMETERS/clsmf25_parms/SouthAsia_0.1-deg/soil_param.datCLSMF25 topo ar file:            ./LS_PARAMETERS/clsmf25_parms/SouthAsia_0.1-deg/ar.newCLSMF25 topo bf file:            ./LS_PARAMETERS/clsmf25_parms/SouthAsia_0.1-deg/bf.datCLSMF25 topo ts file:            ./LS_PARAMETERS/clsmf25_parms/SouthAsia_0.1-deg/ts.datCLSMF25 surf layer ts file:      ./LS_PARAMETERS/clsmf25_parms/SouthAsia_0.1-deg/tau_param.datCLSMF25 MODIS directory:         ./LS_PARAMETERS/cat_parms/MODIS_alb/CLSMF25 greenness climatology file:  ./LS_PARAMETERS/clsmf25_parms/SouthAsia_0.1-deg/green.dataCLSMF25 LAI climatology file:    ./LS_PARAMETERS/clsmf25_parms/SouthAsia_0.1-deg/lai.dataCLSMF25 add to bedrock depth:      2.0CLSMF25 top soil layer depth:       0.02      # in metersCLSMF25 map projection:             latlonCLSMF25 spatial transform:           noneCLSMF25 lower left lat:              5.95CLSMF25 lower left lon:             59.95CLSMF25 upper right lat:            40.05CLSMF25 upper right lon:           100.05CLSMF25 resolution (dx):             0.1CLSMF25 resolution (dy):             0.1#Soil parameter inputsPorosity data source: CLSMF2.5Porosity map:       ./LS_PARAMETERS/clsmf25_parms/SouthAsia_0.1-deg/soil_param.datSaturated matric potential map:Saturated hydraulic conductivity map:b parameter map:Soils spatial transform:      none    !Note: do not use mode with soil fractionsSoils map projection:        latlonSoils lower left lat:          5.95Soils lower left lon:         59.95Soils upper right lat:        40.05Soils upper right lon:        100.05Soils resolution (dx):          0.1Soils resolution (dy):          0.1Soils fill option:   neighborSoils fill radius:   3Soils fill value:    0.33Porosity fill value: 0.30Soil texture data source:      none# Albedo maps:Albedo NIR factor file: ./LS_PARAMETERS/clsmf25_parms/SouthAsia_0.1-deg/AlbMap.WS.2x5.00-04.monthly-tile.0.7_5.0.datAlbedo VIS factor file: ./LS_PARAMETERS/clsmf25_parms/SouthAsia_0.1-deg/AlbMap.WS.2x5.00-04.monthly-tile.0.3_0.7.datAlbedo climatology interval:     monthly                # monthly | quarterlyAlbedo spatial transform:        none                   # average | neighbor | bilinear | budget-bilinearAlbedo fill option:              neighbor               # none | neighbor | averageAlbedo fill radius:                5                    # Number of pixels to search for neighborAlbedo fill value:                0.14                  # Static value to fill where missingAlbedo map projection:           latlonAlbedo lower left lat:              5.95Albedo lower left lon:             59.95Albedo upper right lat:            40.05Albedo upper right lon:           100.05Albedo resolution (dx):             0.1Albedo resolution (dy):             0.1Elevation data source:         noneSlope data source:             noneAspect data source:            noneAlbedo data source:            noneGreenness data source:         noneLAI data source:               none# DA Obs Domain (and Scaling) Processing:DA observation source:              "GRACE TWS"DA preprocessing method:            "Anomaly correction"Name of the preprocessed DA file:   'GRACEobs'Temporal resolution of CDFs:        "yearly"Number of bins to use in the CDF:   100Temporal averaging interval:        "1da"Apply external mask:                0External mask directory:            noneObservation count threshold:        100## GRACE TWS Dataset Info:#Original files on lisdata:# GRACE raw data filename:           ./GRACE_tws/SWENSON/RT/GRACE.CSR.LAND.RL05.DS.G200KM.nc# GRACE measurement error filename:  ./GRACE_tws/SWENSON/RT/CLM4.SCALE_FACTOR.DS.G300KM.nc#Updated v2016 files:GRACE raw data filename:           ./GRACE_JPL_MS/GRCTellus.JPL.200204_201608.GLO.RL05M_1.MSCNv02CRIv02.ncGRACE measurement error filename:  noneGRACE scale factor filename:       none# GRACE scale factor filename:       ./GRACE_tws/download/v2016/CLM4.SCALE_FACTOR.DS.G300KM.RL05.DSTvSCS1409.nc # Note: GRACE data include scale factors and measurement errors ("leakage errors").# Specify the starting and ending years from which to establish the TWS climatology:GRACE baseline starting year:      2004#GRACE baseline ending year:        2016GRACE baseline ending year:        2009# Specify whether to process basin-averaged observations. #  - This is the original method of how GRACE obs were assimilated.GRACE process basin averaged observations:  0GRACE basin map file:  none# LSM output specifications:LIS TWS output model name:         "CLSM F2.5"LIS TWS output format:             "netcdf"LIS TWS output methodology:        "2d gridspace"LIS TWS output naming style:       "3 level hierarchy"LIS TWS output directory:          ./OLv1# LSM Model domain:LIS TWS output nest index:               1LIS TWS output map projection:          "latlon"LIS TWS output domain lower left lat:    5.95LIS TWS output domain lower left lon:    59.95LIS TWS output domain upper right lat:   40.05LIS TWS output domain upper right lon:   100.05LIS TWS output domain resolution (dx):   0.1LIS TWS output domain resolution (dy):   0.1# Specify starting/ending dates valid for GRACE (TELLUS-Mass) Obs:Starting year:                       2002Starting month:                       4Starting day:                         1 Starting hour:                        0 Starting minute:                      0Starting second:                      0Ending year:                         2016Ending month:                         8Ending day:                           31Ending hour:                          0Ending minute:                        0Ending second:                        0LIS output timestep:                 "1da"Maximum number of surface type tiles per grid:     1Minimum cutoff percentage (surface type tiles):    0.10Maximum number of soil texture tiles per grid:     1Minimum cutoff percentage (soil texture tiles):    0.10Maximum number of soil fraction tiles per grid:    1Minimum cutoff percentage (soil fraction tiles):   0.10Maximum number of elevation bands per grid:        1Minimum cutoff percentage (elevation bands):       0.10Maximum number of slope bands per grid:            1Minimum cutoff percentage (slope bands):           0.10Maximum number of aspect bands per grid:           1Minimum cutoff percentage (aspect bands):          0.10A.5. lis.config_20mmobserr_20mems#Overall driver optionsRunning mode:                          "ensemble smoother"Number of nests:                        1Number of surface model types:          1Surface model types:                    LSMLand surface model:                    "CLSM F2.5"Surface model output interval:          1daMap projection of the LIS domain:       latlonNumber of met forcing sources:          1Met forcing sources:                "GDAS"Blending method for forcings:       "overlay"Topographic correction method (met forcing):  "lapse-rate"Enable spatial downscaling of precipitation:   0   0Spatial interpolation method (met forcing):   "bilinear"Temporal interpolation method (met forcing):  "linear"Spatial upscaling method (met forcing):       "none"# Number of EnKS ensemble members:Number of ensembles per tile:             20#Runtime optionsForcing variables list file:              ./CLSM_InputFiles/forcing_variables.txtOutput forcing:                            1   #1-yesOutput parameters:                         0   #0- noOutput methodology:                        "2d gridspace"Output model restart files:                1Output data format:                        "netcdf"Output naming style:                       "3 level hierarchy"Start mode:                                restart Starting year:                             2004Starting month:                            1Starting day:                              1Starting hour:                             0Starting minute:                           0Starting second:                           0Ending year:                               2016Ending month:                              8Ending day:                                31Ending hour:                               23Ending minute:                             55Ending second:                             59Undefined value:                          -9999Output directory:                         "./DA_TWS/GRACEDA_20mmNS_20mems/"Diagnostic output file:                   "./DA_TWS/GRACEDA_20mmNS_20mems/lislog"HYMAP diagnostic output file:             "./DA_TWS/GRACEDA_20mmNS_20mems/hymaplog"#The following options are used for subgrid tiling based on vegetationMaximum number of surface type tiles per grid:    1Minimum cutoff percentage (surface type tiles):   0.05Maximum number of soil texture tiles per grid:    1Minimum cutoff percentage (soil texture tiles):   0.05Maximum number of soil fraction tiles per grid:   1Minimum cutoff percentage (soil fraction tiles):  0.05Maximum number of elevation bands per grid:       1Minimum cutoff percentage (elevation bands):      0.05Maximum number of slope bands per grid:           1Minimum cutoff percentage (slope bands):          0.05Maximum number of aspect bands per grid:          1Minimum cutoff percentage (aspect bands):         0.05#Processor layout#Should match the total number of processor usedNumber of processors along x:           8Number of processors along y:           8# No Halo:#Halo size along x:                      0#Halo size along y:                      0# Include halo (for 0.25deg*4=1.0):Halo size along x:                      10Halo size along y:                      10#Sub-modelsRadiative transfer model:               noneNumber of application models:           0#--------------------- DATA ASSIMILATION ----------------------------------#Data Assimilation OptionsNumber of data assimilation instances:     1 Data assimilation algorithm:               "EnKS"Data assimilation set:                     "GRACE TWS"Data assimilation exclude analysis increments:      0Data assimilation number of observation types:      1Data assimilation output interval for diagnostics:  "1da"Data assimilation output processed observations:    1Data assimilation output ensemble spread:           1 Data assimilation output innovations:               1Data assimilation scaling strategy:                 noneData assimilation use a trained forward model:      0Data assimilation trained forward model output file: none#Bias estimation optionsBias estimation algorithm:                 noneBias estimation attributes file:           noneBias estimation restart output frequency:  1daBias estimation start mode:                noneBias estimation restart file:              none#Perturbation optionsPerturbations start mode:                  restartPerturbations restart output interval:     "1mo"Perturbations restart filename:           ./DA_TWS/GRACEDA_20mmNS_20mems/DAPERT/200312/LIS_DAPERT_200312312330.d01.bin # E.g. filenameForcing perturbation algorithm:           "GMAO scheme"Forcing perturbation frequency:            1hrForcing attributes file:                  ./forcing_attribs/forcing_attribs.txt   # Temperature not includedForcing perturbation attributes file:     ./forcing_attribs/forcing_pert_attribs_kumar_etal2016_jhm.txtState perturbation algorithm:              "GMAO scheme" State perturbation frequency:              3hr   State attributes file:                    ./clsm_tws_files/clsm_tws_attribs.txtState perturbation attributes file:       ./clsm_tws_files/clsm_tws_pertattribs.txtObservation perturbation algorithm:       "GMAO scheme"Observation perturbation frequency:        6hrObservation attributes file:              ./GRACEtws_files/GRACEtws_attribs_20mm_kumaretal2016jhm.txtObservation perturbation attributes file: ./GRACEtws_files/GRACEtws_pertattribs_kumaretal2016jhm.txtApply perturbation bias correction:       1# Set of Observations to be assimilated:GRACE data directory:                        ./DA_TWS/GRACEOBS_JPLmsGRACE use reported measurement error values:  1Data assimilation observation domain file:   ./DA_TWS/GRACEOBS_JPLms/GRACEobs_domain.nc#------------------------------ PARAMETERS ----------------------------------#The following options list the choice of parameter maps to be usedLIS domain and parameter data file:    ./lis_input_clsm_saldas.10.ncLandmask data source:                   LDTLandcover data source:                  LDTSoil texture data source:               noneSoil fraction data source:              noneSoil color data source:                 noneElevation data source:                  LDTSlope data source:                      noneAspect data source:                     noneCurvature data source:                  noneLAI data source:                        LDTSAI data source:                        noneAlbedo data source:                     noneMax snow albedo data source:            noneGreenness data source:                  LDTRoughness data source:                  nonePorosity data source:                   LDTKsat data source:                       noneB parameter data source:                noneQuartz data source:                     noneEmissivity data source:                 none#------------------------------ FORCINGS --------------------------------GDAS forcing directory:                   ./MET_FORCING/GDASGDAS domain x-dimension size:             512GDAS domain y-dimension size:             256GDAS number of forcing variables:         9#-----------------------LAND SURFACE MODELS--------------------------CLSM F2.5 model timestep:                 30mnCLSM F2.5 restart output interval:        1mo#CLSM F2.5 restart file:                  ./clsm_ol_ensrst_200204_init_200203312330.ncCLSM F2.5 restart file:                  ./DA_TWS/GRACEDA_20mmNS_20mems/SURFACEMODEL/200312/LIS_RST_CLSMF25_200312312330.d01.ncCLSM F2.5 top soil layer depth:           0.02      # in metersCLSM F2.5 initial soil moisture:          0.30CLSM F2.5 initial soil temperature:       290.0CLSM F2.5 fixed reference height:         10CLSM F2.5 turbulence scheme:              0CLSM F2.5 use MODIS albedo flag:          1Scaling factor file:                      none#---------------------------MODEL OUTPUT CONFIGURATION-----------------------#Specify the list of ALMA variables that need to be featured in theModel output attributes file:           './CLSM_InputFiles/MODEL_OUTPUT_LIST_CLSM25.TBL'#LSM model outputOutput start year:Output start month:Output start day:Output start hour:Output start minutes:Output start seconds:Appendix B: Post-processingB.1. lvt.config_clim_perc_twsLVT running mode:                   "Data intercomparison"Map projection of the LVT analysis: "latlon"Analysis data class:                "LSM"            # LSM | Routing | RTM | IrrigationLVT output format:                  "netcdf"         # netcdf | grib1 | binaryLVT output methodology:             "2d gridspace"   # 1d tilespace | 2d gridspace | 1d gridspace#                      1. Dataset to be evaluated; 2. The reference datasetAnalysis data sources:    "LIS output" "none"Start mode:                         coldstart        # coldstart | restartLVT restart output interval:       "1mo"LVT restart filename:               noneStarting year:                      2000Starting month:                     1Starting day:                       3Starting hour:                      0Starting minute:                    0Starting second:                    0Ending year:                        2016Ending month:                       8Ending day:                         31     Ending hour:                        23Ending minute:                      55Ending second:                      55LVT clock timestep:                "1da"    # Timestep used in analysis; best to match tstep of 1st datastreamUndefined value:                   -9999LVT diagnostic file:               ./lvtlog_clsm_clim_tws#LVT analysis domain:    Run domain lower left lat:           5.95 Run domain lower left lon:          59.95 Run domain upper right lat:         40.05 Run domain upper right lon:         100.05 Run domain resolution (dx):          0.10 Run domain resolution (dy):          0.10 # LDT-generated netcdf file with input domain and mask field #  -Note: Run domain extents must be inclusive of landmask specified but doesn't have to exactly match.Input domain and mask data file:   ../lis_input_clsm_saldas.10.nc## Variables to be analyzed and their attributes:LVT datastream attributes table::#SoilMoist   1 1  m3/m3   -    1  3   SoilMoist   1 1  m3/m3   -    1  3#RootMoist   1 1 m3/m3   -   1   1 RootMoist 1 1 m3/m3   -     1  1TWS         1 1  mm      -    1  1 TWS         1 1  mm      -    1  1     # 72 ::# Two datastreams:  1 and 2 have the following inputs --# Short_name, select, units, dir_type, tavg_opt(0-inst,1-tavg), num_vertlevsLVT surface soil layer thickness:   0.10   # Top soil layer thickness (in meters)LVT root zone soil layer thickness:  1.0   # Root zone soil layer thickness for analysis (in meters)#stats specifications (only applicable to retrospective mode)Apply external mask:                        0External mask directory:                    noneCompute information theory metrics:         0 Compute ensemble metrics:                   0 Metrics attributes file:                    ./METRICS_BASIC.TBLObservation count threshold:                0Metrics computation frequency:                "1da" Spatial averaging mode:             "pixel-by-pixel"Metrics output directory:             ./STATS_TWSMetrics output frequency:              "7da"#Time series location file:          ./TS_LOCATIONS.TXTVariable-based stratification:      0 Confidence interval (%):            95External data-based stratification: 0Stratification attributes file:     noneSeasonal cycle minimum count threshold: 0 Seasonal cycle interval type: "monthly"Average diurnal cycle minimum count threshold: 0Apply temporal smoothing to obs:  0 Compute only the climatology for percentiles:     1Scale model data prior to computing percentiles:  0 Percentile scaling mean (input data) filename:Percentile scaling standard deviation (input data) filename:Percentile scaling mean (scaled data) filename:Percentile scaling standard deviation (scaled data) filename:Percentile scaling start time for scaling:Percentile scaling end time for scaling:# LIS-LSM inputs specified (#1: To be evaluated; #2: Reference)LIS output number of surface model types:    1 LIS output surface model types:             "LSM"LIS output analysis data class:             "LSM"        # LSM | Routing | RTM | IrrigationLIS output model name:                      "CLSM F2.5"LIS output interval:                        "1da"LIS output map projection:                  "latlon"LIS output domain and parameter file:   ../lis_input_clsm_saldas.10.ncLIS output directory:                   ../OLv1LIS output naming style:                  "3 level hierarchy"LIS output methodology:                   "2d gridspace"LIS output format:                        "netcdf"      # binary | grib1 | netcdfLIS output attributes file:           ../CLSM_InputFiles/MODEL_OUTPUT_LIST_CLSM25.TBLLIS output maximum number of surface type tiles per grid:     1LIS output minimum cutoff percentage (surface type tiles):    0.10LIS output maximum number of soil texture tiles per grid:     1LIS output minimum cutoff percentage (soil texture tiles):    0.10LIS output maximum number of soil fraction tiles per grid:    1LIS output minimum cutoff percentage (soil fraction tiles):   0.10LIS output maximum number of elevation bands per grid:        1LIS output minimum cutoff percentage (elevation bands):       0.10LIS output maximum number of slope bands per grid:            1LIS output minimum cutoff percentage (slope bands):           0.10LIS output maximum number of aspect bands per grid:           1LIS output minimum cutoff percentage (aspect bands):          0.10LIS output number of ensembles per tile:       1LIS output nest index:                         1LIS output elevation data source:              noneLIS output slope data source:                  noneLIS output aspect data source:                 noneLIS output soil texture data source:           noneLIS output soil fraction data source:          noneLIS output number of soil moisture layers:     3LIS output number of soil temperature layers:  6LIS output soil moisture layer thickness:      0.2 1.0 2.0LIS output soil temperature layer thickness:   0.05 0.10 0.19 0.39 0.76 1.51B.2. getPERCall.ncldiriSF="your-path-to /SALDAS/PERC/SFSM/"diriRTZ=" your-path-to /SALDAS/PERC/RTZSM/"diriTWS=" your-path-to /SALDAS/PERC/TWS/"diro=" your-path-to/SALDAS/ncl/output/data/OL/"syr=2003eyr=2015nyr=eyr-syr+1TIME=yyyymmdd_time(2000,2016,"integer")timeyr=TIME({20030106:20151228:7})yrcount=new(nyr+1,"integer",0)do y=0,nyr-1	yr=syr+yfils1=systemfunc("ls "+diriSF+"Percentile_TS."+yr+"*.nc")fils2=systemfunc("ls "+diriRTZ+"Percentile_TS."+yr+"*.nc")fils3=systemfunc("ls "+diriTWS+"Percentile_TS."+yr+"*.nc")sqsort(fils1)sqsort(fils2)sqsort(fils3)f1=addfiles(fils1,"r")ListSetType(f1,"join")f2=addfiles(fils2,"r")ListSetType(f2,"join")f3=addfiles(fils3,"r")ListSetType(f3,"join")yrcount(y+1)=dimsizes(fils1)lat=fspan(5.95,40.05,342)lat@units="degree_north"lat@standard_name = "latitude"lat@long_name = "latitude"lat@missing_value = -9999.lat@_FillValue = -9999.lat!0="lat"lat&lat=latlon=fspan(59.95,100.05,402)lon@units = "degree_east"lon@standard_name = "longitude"lon@long_name = "longitude"lon@missing_value = -9999.lon@_FillValue = -9999.lon!0="lon"lon&lon=lontime=timeyr(sum(yrcount(0:y)):sum(yrcount(0:y+1))-1)SurfaceSoil=f1[:]->SoilMoist_from_SoilMoist_ds1SurfaceSoilPercentile=SurfaceSoil*100printVarSummary(SurfaceSoilPercentile)SurfaceSoilPercentile!0="time"SurfaceSoilPercentile&time=timeSurfaceSoilPercentile!1="lat"SurfaceSoilPercentile&lat=latSurfaceSoilPercentile!2="lon"SurfaceSoilPercentile&lon=lonRootzoneSoil=f2[:]->RootMoist_from_RootMoist_ds1RootzoneSoilPercentile=RootzoneSoil*100RootzoneSoilPercentile!0="time"RootzoneSoilPercentile&time=timeRootzoneSoilPercentile!1="lat"RootzoneSoilPercentile&lat=latRootzoneSoilPercentile!2="lon"RootzoneSoilPercentile&lon=lonTWS=f3[:]->TWS_from_TWS_ds1TWSPercentile=TWS*100TWSPercentile!0="time"TWSPercentile&time=timeTWSPercentile!0="time"TWSPercentile&time=timeTWSPercentile!1="lat"TWSPercentile&lat=latTWSPercentile!2="lon"TWSPercentile&lon=lonb=addfile(diro+"DroughtPercentiles."+yr+".nc","c")b->time=timeb->lat=latb->lon=lonb->SurfaceSoilPercentile=SurfaceSoilPercentileb->RootzoneSoilPercentile=RootzoneSoilPercentileb->TWSPercentile=TWSPercentiledelete([/fils1,fils2,fils3,f1,f2,f3,time,SurfaceSoil,RootzoneSoil,TWS,SurfaceSoilPercentile,RootzoneSoilPercentile,TWSPercentile/])end doB.3. data structureThese are the final files for Tethys input:This is a sample data structure for one file: